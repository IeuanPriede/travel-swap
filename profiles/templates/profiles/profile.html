{% extends "base.html" %}
{% load image_extras %}

{% block content %}
    <h1>{{ profile.user.username }}'s Profile</h1>
    {% if average_rating %}
    <p><strong>Average Rating:</strong>
        {{ average_rating }} 
        {% for i in "12345" %}
        {% if average_rating|floatformat:1 >= i|add:"0" %}
            <i class="fas fa-star text-warning"></i>
        {% else %}
            <i class="far fa-star text-muted"></i>
        {% endif %}
        {% endfor %}
    </p>
    {% endif %}
    <p>Email: {{ profile.user.email }}</p>
    <p>Bio: {{ profile.bio }}</p>
    <p>Location: {{ profile.location }}</p>
    <ul>
        {% if profile.pets_allowed %}<li>Pets Allowed</li>{% endif %}
        {% if profile.has_pool %}<li>Pool</li>{% endif %}
        {% if profile.more_than_3_bedrooms %}<li>3+ Bedrooms</li>{% endif %}
        {% if profile.near_beach %}<li>Beach Nearby</li>{% endif %}
        {% if profile.in_mountains %}<li>Mountain Area</li>{% endif %}
        {% if profile.in_city %}<li>City</li>{% endif %}
        {% if profile.in_rural %}<li>Rural</li>{% endif %}
    </ul>
  
    <h3 class="mt-4">House Images</h3>
    <div class="row">
        {% for image in house_images %}
            {% if image.image %}
                <div class="col-md-4 mb-3">
                    <img src="{{ image.image.url }}" class="img-fluid rounded shadow" alt="House Image">
                </div>
            {% else %}
                <p>No image available for this entry.</p>
            {% endif %}
        {% empty %}
            <p>No images uploaded yet.</p>
        {% endfor %}
    </div>

    <h4 class="mt-4">Reviews About You</h4>

    {% for review in reviews %}
    <div class="card my-2 p-2">
        <strong>{{ review.reviewer.username }}</strong> rated:
        {% for i in "12345" %}
        {% if review.rating|add:"0" >= i|add:"0" %}
            <i class="fas fa-star text-warning"></i>
        {% else %}
            <i class="far fa-star text-muted"></i>
        {% endif %}
        {% endfor %}
        <p>{{ review.comment }}</p>
        <small class="text-muted">{{ review.created_at|date:"F j, Y" }}</small>
    </div>
    {% empty %}
    <p>You haven't received any reviews yet.</p>
    {% endfor %}
  
  <!-- Edit profile button -->
  <a href="{% url 'edit_profile' %}" class="btn btn-primary">Edit Profile</a>
{% endblock %}
